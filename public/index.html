<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Switch — Roblox Game Studio</title>
    <link rel="icon" type="image/png" href="logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FBBF24;
            --bg: #0A0A0A;
            --surface: #111111;
            --surface-mid: #181818;
            --border: #242424;
            --text: #F5F5F5;
            --muted: #808080;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        h1, h2, h3, h4 {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            line-height: 1.1;
        }

        /* ── HERO ── */
        .hero {
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 80px 2rem 4rem;
            overflow: hidden;
        }

        .hero-bg {
            position: absolute;
            inset: 0;
            z-index: 0;
        }

        .hero-bg img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.3;
        }

        /* Dark gradient overlays — no color glow, just darkness */
        .hero-bg::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom, rgba(10,10,10,0.3) 0%, rgba(10,10,10,0.5) 60%, rgba(10,10,10,1) 100%);
        }

        .hero-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .hero-logo {
            max-width: min(88vw, 720px);
            height: auto;
            margin-bottom: 1.75rem;
        }

        .hero-sub {
            font-size: clamp(1rem, 1.8vw, 1.2rem);
            color: var(--muted);
            max-width: 520px;
            margin-bottom: 2.5rem;
            font-weight: 400;
            letter-spacing: 0.01em;
        }

        .hero-btns {
            display: flex;
            gap: 0.875rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        /* ── BUTTONS ── */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.75rem;
            border-radius: 4px;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 0.875rem;
            text-decoration: none;
            cursor: pointer;
            border: none;
            transition: background 0.15s, color 0.15s, border-color 0.15s;
            letter-spacing: 0.02em;
        }

        .btn-primary {
            background: var(--primary);
            color: #000;
        }
        .btn-primary:hover { background: #E5A800; }

        .btn-outline {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.25);
            color: var(--text);
        }
        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        /* ── SCROLL INDICATOR ── */
        .scroll-hint {
            position: absolute;
            bottom: 2.5rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            color: var(--muted);
            font-size: 0.7rem;
            letter-spacing: 0.12em;
            text-transform: uppercase;
        }

        .scroll-hint-line {
            width: 1px;
            height: 40px;
            background: linear-gradient(to bottom, var(--muted), transparent);
            animation: scrollLine 1.8s ease-in-out infinite;
        }

        @keyframes scrollLine {
            0%, 100% { transform: scaleY(1); opacity: 1; }
            50% { transform: scaleY(0.5); opacity: 0.4; }
        }

        /* ── STATS ── */
        .stats-bar {
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            background: var(--surface);
        }

        .stats-inner {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 2rem;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 800;
            color: var(--primary);
            display: block;
            margin-bottom: 0.25rem;
            letter-spacing: -0.02em;
        }

        .stat-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--muted);
        }

        /* ── FEATURED GAME ── */
        .featured-section {
            max-width: 1200px;
            margin: 0 auto;
            padding: 5rem 2rem;
        }

        .section-label {
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.18em;
            color: var(--primary);
            margin-bottom: 0.75rem;
            display: block;
        }

        .section-heading {
            font-size: clamp(1.75rem, 3vw, 2.5rem);
            font-weight: 800;
            margin-bottom: 3rem;
        }

        .featured-card {
            display: grid;
            grid-template-columns: 1.4fr 1fr;
            border: 1px solid var(--border);
            background: var(--surface);
            overflow: hidden;
        }

        .featured-img-wrap {
            position: relative;
            overflow: hidden;
            aspect-ratio: 16/9;
            cursor: pointer;
        }

        .featured-img-wrap img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .featured-img-wrap:hover img { transform: scale(1.04); }

        .featured-info {
            padding: 3rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            border-left: 1px solid var(--border);
        }

        .featured-name {
            font-size: 1.75rem;
            font-weight: 800;
            margin-bottom: 1rem;
        }

        .featured-desc {
            color: var(--muted);
            font-size: 0.95rem;
            line-height: 1.7;
            margin-bottom: 2rem;
        }

        .featured-nums {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            padding: 1.5rem 0;
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            margin-bottom: 2rem;
        }

        .featured-num-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--muted);
            margin-bottom: 0.375rem;
        }

        .featured-num-val {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--primary);
        }

        /* ── BLOG ── */
        .blog-section {
            border-top: 1px solid var(--border);
            padding: 5rem 2rem;
        }

        .blog-inner {
            max-width: 1200px;
            margin: 0 auto;
        }

        .blog-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1px;
            border: 1px solid var(--border);
            background: var(--border);
        }

        .blog-card {
            background: var(--surface);
            cursor: pointer;
            transition: background 0.15s;
            display: flex;
            flex-direction: column;
        }

        .blog-card:hover { background: var(--surface-mid); }

        .blog-card-img {
            width: 100%;
            aspect-ratio: 16/9;
            object-fit: cover;
            display: block;
        }

        .blog-card-img-placeholder {
            width: 100%;
            aspect-ratio: 16/9;
            background: var(--surface-mid);
            border-bottom: 1px solid var(--border);
        }

        .blog-card-body {
            padding: 1.75rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .blog-date {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            color: var(--primary);
            margin-bottom: 0.75rem;
        }

        .blog-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            line-height: 1.3;
        }

        .blog-preview {
            color: var(--muted);
            font-size: 0.875rem;
            line-height: 1.65;
            flex: 1;
        }

        .blog-read {
            margin-top: 1.25rem;
            font-size: 0.75rem;
            color: var(--muted);
            letter-spacing: 0.08em;
        }

        /* ── CONTACT ── */
        .contact-section {
            border-top: 1px solid var(--border);
            padding: 5rem 2rem;
        }

        .contact-inner {
            max-width: 700px;
            margin: 0 auto;
        }

        .contact-form {
            margin-top: 3rem;
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.25rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.375rem;
        }

        .form-group label {
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--muted);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            padding: 0.75rem 1rem;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text);
            font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
            outline: none;
            transition: border-color 0.15s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            border-color: var(--primary);
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder { color: #444; }

        .form-status {
            padding: 0.75rem 1rem;
            border-radius: 4px;
            font-size: 0.875rem;
            display: none;
        }

        .form-status.success {
            background: rgba(251,191,36,0.08);
            border: 1px solid rgba(251,191,36,0.2);
            color: var(--primary);
        }

        .form-status.error {
            background: rgba(239,68,68,0.08);
            border: 1px solid rgba(239,68,68,0.2);
            color: #f87171;
        }

        /* ── BLOG MODAL ── */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: rgba(0,0,0,0.85);
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .modal.open { display: flex; }

        .modal-content {
            background: var(--surface);
            border: 1px solid var(--border);
            max-width: 760px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-header {
            padding: 2rem 2rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .modal-meta {
            display: flex;
            gap: 1rem;
            font-size: 0.75rem;
            color: var(--muted);
            letter-spacing: 0.08em;
            text-transform: uppercase;
            margin-bottom: 0.75rem;
        }

        .modal-meta span:first-child { color: var(--primary); }

        .modal-title {
            font-size: 1.75rem;
        }

        .modal-close {
            position: absolute;
            top: 1.25rem;
            right: 1.25rem;
            background: var(--surface-mid);
            border: 1px solid var(--border);
            color: var(--muted);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1rem;
            border-radius: 2px;
            transition: background 0.15s, color 0.15s;
        }

        .modal-close:hover { background: var(--primary); color: #000; border-color: var(--primary); }

        .modal-body {
            padding: 2rem;
            line-height: 1.8;
            color: var(--muted);
            font-size: 1rem;
        }

        .modal-body img {
            max-width: 100%;
            border-radius: 2px;
            margin: 1rem 0;
        }

        /* ── RESPONSIVE ── */
        @media (max-width: 900px) {
            .featured-card { grid-template-columns: 1fr; }
            .featured-info { border-left: none; border-top: 1px solid var(--border); padding: 2rem; }
            .stats-inner { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 600px) {
            .hero { padding: 80px 1.25rem 3rem; }
            .hero-btns { flex-direction: column; width: 100%; max-width: 280px; }
            .btn { justify-content: center; }
            .stats-inner { grid-template-columns: repeat(2, 1fr); gap: 1.5rem; padding: 2rem 1.25rem; }
            .featured-section, .blog-section, .contact-section { padding: 3.5rem 1.25rem; }
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <!-- HERO -->
    <section class="hero">
        <div class="hero-bg">
            <img src="hero.png" alt="">
        </div>
        <div class="hero-content">
            <img src="heroextended.png" alt="Switch" class="hero-logo">
            <p class="hero-sub">An independent Roblox studio building immersive experiences for millions of players.</p>
            <div class="hero-btns">
                <a href="/games" class="btn btn-primary">
                    Explore Games
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                </a>
                <a href="#contact" class="btn btn-outline">Contact Us</a>
            </div>
        </div>
        <div class="scroll-hint">
            <span>Scroll</span>
            <div class="scroll-hint-line"></div>
        </div>
    </section>

    <!-- STATS -->
    <div class="stats-bar">
        <div class="stats-inner">
            <div class="stat">
                <span class="stat-value" id="games-count">—</span>
                <span class="stat-label">Games</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="ccu-display">—</span>
                <span class="stat-label">Playing Now</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="visit-display">—</span>
                <span class="stat-label">Total Visits</span>
            </div>
            <div class="stat">
                <span class="stat-value">2025</span>
                <span class="stat-label">Founded</span>
            </div>
        </div>
    </div>

    <!-- FEATURED GAME -->
    <div id="featured-header" style="display:none;">
        <section class="featured-section">
            <span class="section-label">Now Playing</span>
            <h2 class="section-heading">Featured Game</h2>
            <div class="featured-card" id="featured-game">
                <a href="#" class="featured-img-wrap" id="featured-link">
                    <img src="" alt="" id="featured-img">
                </a>
                <div class="featured-info">
                    <div>
                        <h3 class="featured-name" id="featured-name">—</h3>
                        <p class="featured-desc" id="featured-desc">—</p>
                    </div>
                    <div>
                        <div class="featured-nums">
                            <div>
                                <div class="featured-num-label">Playing Now</div>
                                <div class="featured-num-val" id="featured-playing">—</div>
                            </div>
                            <div>
                                <div class="featured-num-label">Total Visits</div>
                                <div class="featured-num-val" id="featured-visits">—</div>
                            </div>
                        </div>
                        <a href="#" class="btn btn-primary" id="featured-play-btn" style="width:100%;justify-content:center;">
                            Play on Roblox
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
                        </a>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- BLOG -->
    <div class="blog-section" id="blog">
        <div class="blog-inner">
            <span class="section-label">Latest</span>
            <h2 class="section-heading" style="margin-bottom:2rem;">Recent Posts</h2>
            <div class="blog-grid" id="blog-grid">
                <div style="padding:3rem;color:var(--muted);font-size:0.875rem;">Loading posts…</div>
            </div>
        </div>
    </div>

    <!-- BLOG MODAL -->
    <div class="modal" id="blog-modal">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">✕</button>
            <div class="modal-header">
                <div class="modal-meta">
                    <span id="modal-date"></span>
                    <span id="modal-readtime"></span>
                </div>
                <h2 class="modal-title" id="modal-title"></h2>
            </div>
            <div class="modal-body" id="modal-body"></div>
        </div>
    </div>

    <!-- CONTACT -->
    <div class="contact-section" id="contact">
        <div class="contact-inner">
            <span class="section-label">Get in Touch</span>
            <h2 class="section-heading">Contact Us</h2>
            <form id="contact-form" class="contact-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Name *</label>
                        <input type="text" id="contact-name" required placeholder="Your name">
                    </div>
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="contact-email" required placeholder="you@email.com">
                    </div>
                </div>
                <div class="form-group">
                    <label>Subject *</label>
                    <input type="text" id="contact-subject" required placeholder="What's this about?">
                </div>
                <div class="form-group">
                    <label>Message *</label>
                    <textarea id="contact-message" rows="6" required placeholder="Tell us more…"></textarea>
                </div>
                <div class="form-status" id="contact-status"></div>
                <button type="submit" class="btn btn-primary" style="width:100%;justify-content:center;">
                    Send Message
                </button>
            </form>
        </div>
    </div>

    <script src="navbar.js"></script>
    <script src="footer.js"></script>
    <script>
        function fmt(n) {
            if (!n || n === 0) return '0';
            if (n >= 1e9) return (n/1e9).toFixed(1)+'B';
            if (n >= 1e6) return (n/1e6).toFixed(1)+'M';
            if (n >= 1e3) return (n/1e3).toFixed(1)+'K';
            return n.toLocaleString();
        }
        function fmtDate(iso) {
            return new Date(iso).toLocaleDateString('en-GB', { day:'numeric', month:'long', year:'numeric' });
        }
        function stripHtml(html) {
            const d = document.createElement('div'); d.innerHTML = html;
            return d.textContent || d.innerText || '';
        }
        function readTime(html) {
            const words = stripHtml(html).split(/\s+/).filter(Boolean).length;
            return Math.max(1, Math.round(words/200))+' min read';
        }
        function preview(html, len=120) {
            const t = stripHtml(html);
            return t.length > len ? t.slice(0,len).trimEnd()+'…' : t;
        }

        async function loadGamesAndStats() {
            try {
                const res = await fetch('/api/games');
                const { games } = await res.json();
                document.getElementById('games-count').textContent = games.length;
                document.getElementById('ccu-display').textContent = fmt(games.reduce((s,g) => s+(g.playing||0),0));
                document.getElementById('visit-display').textContent = fmt(games.reduce((s,g) => s+(g.visits||0),0));
                const featured = games.find(g => g.featured);
                if (featured) {
                    document.getElementById('featured-header').style.display = 'block';
                    document.getElementById('featured-img').src = featured.thumbnail || '';
                    document.getElementById('featured-name').textContent = featured.name || '—';
                    document.getElementById('featured-desc').textContent = featured.description || 'An immersive Roblox experience crafted by the Switch team.';
                    document.getElementById('featured-playing').textContent = fmt(featured.playing||0);
                    document.getElementById('featured-visits').textContent = fmt(featured.visits||0);
                    const url = `https://www.roblox.com/games/${featured.placeId||featured.universeId}`;
                    document.getElementById('featured-link').href = url;
                    document.getElementById('featured-play-btn').href = url;
                }
            } catch(e) { console.error(e); }
        }

        async function loadBlogPosts() {
            try {
                const res = await fetch('/api/blog/posts');
                const { posts } = await res.json();
                const grid = document.getElementById('blog-grid');
                if (!posts || !posts.length) {
                    grid.innerHTML = '<div style="padding:3rem;color:var(--muted);font-size:0.875rem;">No posts yet. Check back soon.</div>';
                    return;
                }
                grid.innerHTML = posts.slice(0,3).map(p => `
                    <div class="blog-card" onclick="openPost(${JSON.stringify(p).replace(/"/g,'&quot;')})">
                        ${p.image ? `<img src="${p.image}" class="blog-card-img" alt="${p.title}" loading="lazy">` : '<div class="blog-card-img-placeholder"></div>'}
                        <div class="blog-card-body">
                            <div class="blog-date">${fmtDate(p.createdAt)}</div>
                            <h3 class="blog-title">${p.title}</h3>
                            <p class="blog-preview">${preview(p.content)}</p>
                            <span class="blog-read">${readTime(p.content)}</span>
                        </div>
                    </div>
                `).join('');
            } catch(e) { console.error(e); }
        }

        function openPost(p) {
            document.getElementById('modal-date').textContent = fmtDate(p.createdAt);
            document.getElementById('modal-readtime').textContent = readTime(p.content);
            document.getElementById('modal-title').textContent = p.title;
            document.getElementById('modal-body').innerHTML = p.content;
            document.getElementById('blog-modal').classList.add('open');
            document.body.style.overflow = 'hidden';
        }
        function closeModal() {
            document.getElementById('blog-modal').classList.remove('open');
            document.body.style.overflow = '';
        }
        document.getElementById('modal-close').addEventListener('click', closeModal);
        document.getElementById('blog-modal').addEventListener('click', e => { if(e.target.id==='blog-modal') closeModal(); });
        document.addEventListener('keydown', e => { if(e.key==='Escape') closeModal(); });

        document.getElementById('contact-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const status = document.getElementById('contact-status');
            const btn = this.querySelector('button[type=submit]');
            btn.disabled = true;
            btn.textContent = 'Sending…';
            try {
                const res = await fetch('/api/contact', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: document.getElementById('contact-name').value,
                        email: document.getElementById('contact-email').value,
                        subject: document.getElementById('contact-subject').value,
                        message: document.getElementById('contact-message').value
                    })
                });
                if (res.ok) {
                    status.textContent = 'Message sent. We\'ll get back to you shortly.';
                    status.className = 'form-status success';
                    status.style.display = 'block';
                    this.reset();
                } else { throw new Error(); }
            } catch {
                status.textContent = 'Something went wrong. Please try again.';
                status.className = 'form-status error';
                status.style.display = 'block';
            } finally {
                btn.disabled = false;
                btn.textContent = 'Send Message';
            }
        });

        loadGamesAndStats();
        loadBlogPosts();
    </script>
</body>
</html>